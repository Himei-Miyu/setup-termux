#!/bin/bash

touch .error.log;

declare -a _0=( "\e[0m" "\e[34m" "\e[32m" "\e[36m" "\e[31m" "\e[35m" "\e[33m" "\e[37m" "\e[90m" "\e[94m" "\e[30m" "\e[92m" "\e[94m" "\e[91m" "\e[95m" "\e[93m" "\e[97m" "\e[1;m" "\e[2;m" "\e[3;m" "\e[4;m" "\e[9;m" );
declare -a _LIBS=(proot-distro);
declare -a _REGEXS=("^$\|WARNING");
declare _PREMSG="${_0[14]}${_0[17]}HIMEI ${_0[8]}> ";
declare -a _MSGS=("-" "Updating packages" "Update packages completed" "Installing packages" "Install packages completed" "Installing packages additional" "Install packages additional completed" "Installing ubuntu" "Install ubuntu completed");
declare -a _ERR=("sed -i '/${_REGEXS[0]}/d' .error.log && echo -e \"${_PREMSG}${_0[13]}$(cat .error.log)\" && exit 1" "cat .error.log && exit 1");

echo -e "$_PREMSG${_0[11]}${_MSGS[1]}";
apt-get update 2> .error.log 1> /dev/null || eval $_ERR;
echo -e "$_PREMSG${_0[11]}${_MSGS[2]}";
echo -e "$_PREMSG${_0[11]}${_MSGS[3]}";
apt-get -o Dpkg::Options::="--force-confdef" -y dist-upgrade 2> .error.log 1> /dev/null || eval $_ERR;
echo -e "$_PREMSG${_0[11]}${_MSGS[4]}";
echo -e "$_PREMSG${_0[11]}${_MSGS[5]}";
pkg i -y ${_LIBS[@]} 2> .error.log 1> /dev/null || eval $_ERR;
echo -e "$_PREMSG${_0[11]}${_MSGS[6]}";
echo -e "$_PREMSG${_0[11]}${_MSGS[7]}";
proot-distro install ubuntu 2> .error.log 1> /dev/null || eval ${_ERR[1]};
echo -e "$_PREMSG${_0[11]}${_MSGS[8]}${_0[0]}";
proot-distro login ubuntu 2>&1 | grep -v "proot\swarning";

touch .error.log;

declare -a _INFOS=($(cat "/etc/os-release" | sed 's/^.*\=\|\"//g' | sed 's/\s/\_/g'));
declare -a _0=( "\e[0m" "\e[34m" "\e[32m" "\e[36m" "\e[31m" "\e[35m" "\e[33m" "\e[37m" "\e[90m" "\e[94m" "\e[30m" "\e[92m" "\e[94m" "\e[91m" "\e[95m" "\e[93m" "\e[97m" "\e[1;m" "\e[2;m" "\e[3;m" "\e[4;m" "\e[9;m" );
declare -a _REGEXS=("^$\|WARNING");
declare _PREMSG="${_0[14]}${_0[17]}HIMEI ${_0[8]}> ";
declare -a _MSGS=("-" "Updating packages" "Update packages completed" "Installing packages" "Install packages completed" "Installing packages additional" "Install packages additional completed" "Installing ubuntu" "Install ubuntu completed" "Welcome to ${_INFOS[1]} ${_INFOS[3]//_/ }" "Starting install packages ubuntu");
declare -a _ERR=("sed -i '/${_REGEXS[0]}/d' .error.log && echo -e \"${_PREMSG}${_0[13]}$(cat .error.log)\" && exit 1" "cat .error.log && exit 1");

echo -e "$_PREMSG${_0[11]}${_MSGS[10]}";
echo -e "$_PREMSG${_0[11]}${_MSGS[1]}";
apt-get update 2> .error.log 1> /dev/null || eval $_ERR;
echo -e "$_PREMSG${_0[11]}${_MSGS[2]}";
echo -e "$_PREMSG${_0[11]}${_MSGS[3]}";
apt-get -o Dpkg::Options::="--force-confdef" -y dist-upgrade 2> .error.log 1> /dev/null || eval $_ERR;
echo -e "$_PREMSG${_0[11]}${_MSGS[4]}";
sleep 2 && clear;
echo -e "${_0[12]}${_MSGS[9]}";
unset _INFOS _0 _LIBS _REGEXS _PREMSG _MSGS _ERR;
rm -rf .error.log;
exit 0;

echo -e "${_0[11]}run ${_0[7]}\"${_0[14]}proot-distro login ubuntu --shared-tmp${_0[7]}\"${_0[0]}";

unset _0 _LIBS _REGEXS _MSGS _ERR;
rm -rf .error.log;
